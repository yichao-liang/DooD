{'anneal_lr': True,
 'anneal_non_pr_net_lr': True,
 'batch_size': 64,
 'bern_img_dist': False,
 'beta': 1.0,
 'bl_lr': 0.001,
 'bl_mlp_hid_dim': 256,
 'bl_rnn_hid_dim': 256,
 'canvas_only_to_zwhere': False,
 'constrain_sample': False,
 'constrain_z_pres_param': False,
 'continue_training': False,
 'data_dir': './omniglot_dataset/omniglot/',
 'dataset': 'MNIST',
 'dependent_prior': True,
 'detach_canvas_embed': False,
 'detach_canvas_so_far': True,
 'detach_rsd_embed': False,
 'feature_extractor_sharing': True,
 'final_bern': 0.5,
 'final_beta': 1,
 'global_reinforce_signal': False,
 'img_res': 50,
 'increase_beta': False,
 'inference_dist': 'Normal',
 'inference_net_architecture': 'CNN',
 'input_dependent_render_param': True,
 'intermediate_likelihood': None,
 'likelihood_dist': 'Laplace',
 'linear_sum': True,
 'log_grad': False,
 'log_interval': 50,
 'log_param': True,
 'loss': 'elbo',
 'lr': 0.001,
 'model_type': 'Sequential',
 'no_add_strk_tanh': False,
 'no_detach_rsd': False,
 'no_maxnorm': False,
 'no_post_rnn': False,
 'no_pres_post_rnn': True,
 'no_pres_rnn': False,
 'no_rnn': False,
 'no_sgl_strk_tanh': False,
 'no_spline_renderer': False,
 'no_what_post_rnn': False,
 'num_baseline_layers': 3,
 'num_iterations': 500000,
 'num_mlp_layers': 2,
 'only_rsd_ratio_pres': False,
 'points_per_stroke': 5,
 'prior_dependency': 'wt|wr',
 'prior_dist': 'Sequential',
 'render_at_the_end': False,
 'render_method': 'base',
 'residual_no_target': False,
 'residual_pixel_count': True,
 'save_history_ckpt': False,
 'save_interval': 1000,
 'save_model_name': 'Full-spDec-sqPrior-dp-tr-detachRsdNotRsdEm-sepPrWrNet-noPrPosRnn-normRfLoss-anNonPrLr-lapl-65strk-β1-0',
 'seed': '0',
 'sep_where_pres_net': True,
 'simple_pres': False,
 'strokes_per_img': 6,
 'target_in_pos': 'MLP',
 'tb_dir': '/om/user/ycliang/log/debug/Full-spDec-sqPrior-dp-tr-detachRsdNotRsdEm-sepPrWrNet-noPrPosRnn-normRfLoss-anNonPrLr-lapl-65strk-β1-0',
 'transform_z_what': False,
 'update_reinforce_ll': False,
 'update_reinforce_loss': True,
 'use_canvas': True,
 'use_residual': True,
 'weight_decay': 0.0,
 'z_dim': 10,
 'z_what_in_pos': 'z_what_rnn',
 'z_where_type': '4_rotate'}
07:02:43 | /net/vast-storage/scratch/vast/tenenbaum/ycliang/hierarchical/handwritten_characters/util.py:1267 | INFO: Using CPU
07:02:43 | /net/vast-storage/scratch/vast/tenenbaum/ycliang/hierarchical/handwritten_characters/run.py:41 | INFO: Training from scratch
/om2/user/ycliang/miniconda3/envs/glot/lib/python3.9/site-packages/torch/utils/data/dataloader.py:478: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
/om2/user/ycliang/miniconda3/envs/glot/lib/python3.9/site-packages/torch/functional.py:445: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1639180487213/work/aten/src/ATen/native/TensorShape.cpp:2157.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
epoch 0
[[[0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]
  [0.998 0.998 0.998 0.998 0.998 0.998]]]
Traceback (most recent call last):
  File "/net/vast-storage/scratch/vast/tenenbaum/ycliang/hierarchical/handwritten_characters/run.py", line 430, in <module>
    main(args)
  File "/net/vast-storage/scratch/vast/tenenbaum/ycliang/hierarchical/handwritten_characters/run.py", line 66, in main
    train.train(model, optimizer, scheduler, stats, data_loader, args, writer,
  File "/net/vast-storage/scratch/vast/tenenbaum/ycliang/hierarchical/handwritten_characters/train.py", line 71, in train
    plot.plot_reconstructions(imgs=imgs, guide=guide, 
  File "/net/vast-storage/scratch/vast/tenenbaum/ycliang/hierarchical/handwritten_characters/plot.py", line 336, in plot_reconstructions
    pts = transformed_z_what = util.transform_z_what(
  File "/net/vast-storage/scratch/vast/tenenbaum/ycliang/hierarchical/handwritten_characters/util.py", line 360, in transform_z_what
    center = ((ag[:, l_coord, l_coord].cuda() + 
  File "/om2/user/ycliang/miniconda3/envs/glot/lib/python3.9/site-packages/torch/cuda/__init__.py", line 214, in _lazy_init
    torch._C._cuda_init()
RuntimeError: No CUDA GPUs are available
==> Begin training the 'Full-spDec-sqPrior-dp-tr-detachRsdNotRsdEm-sepPrWrNet-noPrPosRnn-normRfLoss-anNonPrLr-lapl-65strk-β1-0' model
==> Done training Full-spDec-sqPrior-dp-tr-detachRsdNotRsdEm-sepPrWrNet-noPrPosRnn-normRfLoss-anNonPrLr-lapl-65strk

